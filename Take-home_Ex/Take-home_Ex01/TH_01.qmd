---
title: "Take-home Exercise 1: Beyond the Harvest"
author: "Nguyen Trong Nhan"
date: "14 February 2026"
date-modified: "last-modified"
format: html
code-fold: true
code-summary: "Show code"
editor: visual
freeze: true
execute:
  eval: true
  echo: true
  warning: false
---

```{=html}
<style>
p {
  text-align: justify;
}
body, 
body p, 
body h1, 
body h2, 
body h3, 
body h4, 
body h5, 
body h6, 
body li {
  color: #000 !important;
}
</style>
```

# Beyond the Harvest: What the Fields Do Not Yield

# Prologue: Echoes of History, Culture, and Religion

![](images/clipboard-2115636119.png) **Figure 1.** **Buddha, Lao Tzu, and Confucius**

(Source: [Smithsonian](https://www.si.edu/object/fsg_F1916.109))

Throughout the long and often turbulent history of Vietnam, society has been shaped by the philosophical convergence commonly described as **"Tam Giáo Đồng Nguyên"** (The Three Teachings - 三教同源): the blending of Confucianism, Buddhism, and Taoism. These traditions did not merely guide spiritual life; they profoundly influenced social expectations, economic roles, and the perceived hierarchy of labor within a largely agrarian civilization.

One of the most enduring frameworks to emerge from this worldview was the concept of **"Tứ Dân"** (The Four Occupations - 士農工商): **"Sĩ, Nông, Công, Thương"**. Scholar-officials (士) occupied the highest rung, entrusted with governance and moral leadership. Farmers (农) formed the backbone of the nation, sustaining both economy and culture. Artisans (工) represented skilled productivity, while merchants (商), despite their economic importance, often occupied an ambiguous moral position due to Confucian skepticism toward profit-driven pursuits.

Although Vietnam officially transitioned away from feudal structures in the twentieth century, culminating in national independence in 1945 and ultimate reunification in 1975, the social logic embedded within these historical classifications did not disappear overnight. Instead, they evolved into modern forms: education remains a gateway to upward mobility reminiscent of the scholar class; agriculture continues as both a cultural foundation and a persistent economic constraint; artisanal skills have transformed into small-scale informal industries; and trade and service work occupy a shifting space between opportunity and precarity.

In rural and mountainous regions, where geography, ethnic diversity, and uneven development intersect, these historical echoes still influence economic outcomes. Modern laborers are no longer bound by imperial exams or rigid caste-like roles, yet structural legacies remain visible through educational disparities, occupational segregation, and unequal access to markets and capital.

**This report begins from that historical consciousness.** The data analysis presented here is not simply an analysis of numbers; it is a contemporary reflection of how centuries-old social patterns continue to shape livelihoods. By examining income structures, employment sectors, and demographic characteristics among informal rural workers, **I attempt to understand whether Vietnam has truly moved beyond the legacy of the old occupations, or whether those ancient divisions still cast long shadows over modern economic mobility.**

# Foreword

In this analysis, titled **"Beyond the Harvest: What the Fields Do Not Yield,"** I adopt the lens of a socio-economic analyst examining the livelihoods of informal laborers in Vietnam's Northern Mountainous Region. Using a dataset of 725 rural workers, this report moves beyond simple descriptive statistics to uncover the structural "ceilings" and "floors" of rural income.

I will examine how education, gender, and ethnicity interact to shape economic destiny in these developing provinces, aiming to tell a truthful and enlightening story about the barriers to upward mobility.

![](images/clipboard-178225604.png)

**Figure 2. Rice fields in Northern Vietnam**

(Source: [Travel Sense Asia](https://en.travelsense.asia/experience-rice-fields-in-northern-vietnam/))

# 1. Getting Started

## 1.1 Importing Packages

We will use the tidyverse family for data processing and ggplot2 (along with ggthemes and patchwork) for the visualisations.

```{r}
pacman::p_load(tidyverse, ggthemes, patchwork, knitr, ggridges, ggtext, readxl)
```

## 1.2 Importing Data

The dataset comes from a survey of informal laborers in rural areas of northern Vietnam. I have attained this data as per the [research paper's](https://www.sciencedirect.com/science/article/pii/S235234092100576X) requirement.

It can be found on [Mendeley Data](https://data.mendeley.com/datasets/s6p7dwj3j6/).

```{r}
#| message: false 
# Load the dataset 
raw_data <- read_excel("data/Upload for elsiver.xlsx")
glimpse(raw_data)
```

# 2. Data Cleaning and Quality Assurance

Before analysis, the data must be transformed from raw numerical codes into meaningful categorical factors, as per the research paper's specifications.

## 2.1 Mapping Categorical Variables

::: callout-note
## Data dictionary & Coding strategy

The raw dataset utilizes numerical integers (e.g., 1, 2) to represent categorical variables. To ensure our analysis is readable and our visualization legends are self-explanatory, I will perform the following specific transformations based on the Mai et al. (2021) metadata:

1.  **Province (`CPRO`)**: Recoded `1`-`5` $\rightarrow$ "Tuyen Quang", "Quang Ninh", "Ha Giang", "Yen Bai", "Bac Giang".
2.  **Gender (`CGEN`):** Recoded `1` $\rightarrow$ **"Male"** and `2` $\rightarrow$ **"Female"**.
3.  **Ethnicity (`CRAC`):** Recoded `1` $\rightarrow$ **"Kinh"** (the majority ethnic group) and `2` $\rightarrow$ **"Minorities"**.
4.  **Job Type (`CJOB`):** Recoded `1` $\rightarrow$ **"Agriculture"**, `2` $\rightarrow$ **"Service/Ind"**, and `3` $\rightarrow$ **"Others"**.
5.  **Education (`FEDU`):** Converted from an integer scale to an ordered factor:
    -   `0` $\rightarrow$ **"None/Other"**

    -   `1` $\rightarrow$ **"Primary"**

    -   `2` $\rightarrow$ **"Lower Secondary"**

    -   `3` $\rightarrow$ **"Upper Secondary"**

    -   *Rationale:* This explicit ordering ensures that plots display education levels in their logical progression rather than alphabetically.
6.  **Income Quintile (`CQUI`)**: Converted to an ordered factor: `1` $\rightarrow$ **"Top"**, `2` $\rightarrow$ **"Fourth"**, `3` $\rightarrow$ **"Middle"**, `4` $\rightarrow$ **"Second"**, `5` $\rightarrow$ **"Lowest"**.
7.  **Credit Accessibility (`FCRA`)**: Recoded `1` $\rightarrow$ **"No Credit"** and `2` $\rightarrow$ **"Has Credit"**.
8.  **Vocational Training (`FVTP`)**: Recoded `1` $\rightarrow$ **"Short Course"** and `2` $\rightarrow$ **"Long Course"**.
:::

```{r}
clean_data <- raw_data %>%
  mutate(
    # Demographics
    Province = factor(CPRO, levels = 1:5, labels = c("Tuyen Quang", "Quang Ninh", "Ha Giang", "Yen Bai", "Bac Giang")),
    Gender = factor(CGEN, levels = c(1, 2), labels = c("Male", "Female")),
    Ethnicity = factor(CRAC, levels = c(1, 2), labels = c("Kinh", "Minorities")),
    
    # Economics & Education
    Job_Type = factor(CJOB, levels = c(1, 2, 3), labels = c("Agriculture", "Service/Ind", "Others")),
    Education = factor(FEDU, levels = c(0, 1, 2, 3), labels = c("None/Other", "Primary", "Lower Sec", "Upper Sec")),
    Quintile = factor(CQUI, levels = c(1, 2, 3, 4, 5), labels = c("Top", "Fourth", "Middle", "Second", "Lowest")),
    
    # Interventions
    Credit = factor(FCRA, levels = c(1, 2), labels = c("No Credit", "Has Credit")),
    Vocational = factor(FVTP, levels = c(1, 2), labels = c("Short Course", "Long Course")),
    
    # Numerics
    Income = as.numeric(TEIN),
    Agri_Income = as.numeric(TAIN),
    Service_Income = as.numeric(TSII),
    Other_Income = as.numeric(TOIN)
  )
```

## 2.2 Quality Check: Missing Values

If core demographic or income data is missing, the row is unusable for our analysis.

```{r}
missing_counts <- clean_data %>%
  select(Income, Gender, Ethnicity, Job_Type, Province) %>%
  summarise_all(~ sum(is.na(.)))

if (sum(missing_counts) > 0) {
  cat("⚠️ Missing values detected. Removing incomplete rows...\n")
  clean_data <- clean_data %>% drop_na(Income, Gender, Ethnicity, Job_Type, Province)
} else {
  cat("✅ No missing values in key columns.\n")
}
```

## 2.3 Quality Check: Validating Income

::: callout-important
### Handling logical inconsistencies

A critical step in economic analysis is verifying that "Income" is a positive, non-zero value. In survey data, a value of 0 or negative numbers often indicates:

-   Missing data: The respondent refused to answer.

-   Unemployment: The respondent is not actually a "laborer."

-   Data entry error.

By definition, our sample consists of "laborers." Therefore, anyone with an income of 0 or below is likely an entry error or unemployed, which would skew our data.

**Action** **taken:** I will filter the dataset to include only rows where Income \> 0. This ensures our logarithmic scales (if used) do not break and our averages represent actual earners.
:::

```{r}
# Check for non-positive income
invalid_income <- clean_data %>% filter(Income <= 0)

if (nrow(invalid_income) > 0) {
  cat("⚠️ Found", nrow(invalid_income), "rows with invalid income (<= 0). Removing them from analysis.\n")
  clean_data <- clean_data %>% filter(Income > 0)
} else {
  cat("✅ Validation passed: All income values are positive (> 0).\n")
}
```

## 2.4 Quality Check: Duplicates

A perfectly identical row often indicates a data-entry error where a survey was submitted twice.

```{r}
dup_count <- sum(duplicated(clean_data))

if (dup_count > 0) {
  cat("⚠️ Found", dup_count, "duplicate rows. Removing them...\n")
  clean_data <- clean_data %>% distinct()
} else {
  cat("✅ No duplicate rows found. Every respondent is unique.\n")
}
```

## 2.5 Final Data Summary

We are finally done with cleaning. Below is a snapshot of the clean dataset we will use for the analysis.

```{r}
# High-level summary of the final clean data
summary_stats <- clean_data %>%
  summarise(
    total_respondents = n(),
    avg_income = mean(Income),
    median_income = median(Income),
    percent_female = mean(Gender == "Female") * 100
  )

# Print summary
print(summary_stats)

cat(sprintf(
  "✅ Final Data Ready: %d respondents.\n   Average Income: %.2f Million VND\n   Female Representation: %.1f%%",
  summary_stats$total_respondents,
  summary_stats$avg_income,
  summary_stats$percent_female
))
```

# 3. The Analysis

The northern mountainous regions of Vietnam are a tapestry of ethnic diversity and agricultural tradition. However, beneath the landscape lies a complex economic reality. The following eight visualizations deconstruct the mechanics of rural income, revealing that while agriculture remains the region's backbone, it frequently acts as a baseline of subsistence rather than a pathway to prosperity. By examining the data, we uncover how macro-geographical divides, systemic gender segregation in the workforce, and compounding ethnic disparities create steep barriers to economic mobility. More importantly, the analysis identifies the critical escape routes: formal education, occupational diversification, and targeted interventions like microfinance, which together serve as the primary ladders for transforming rural livelihoods.

![](images/clipboard-2316088154.png)

**Figure 3. Rice fields in Northern Vietnam**

(Source: [Travel Sense Asia](https://en.travelsense.asia/experience-rice-fields-in-northern-vietnam/))

## 3.1 The Geographic Divide: Income by Province

::: callout-note
### Plot Approach

[***Technical Approach***]{.underline}

I utilized a ridge plot (`geom_density_ridges`) to evaluate the income distribution across the five provinces.

-   The provinces are actively reordered on the Y-axis based on their **median income**, transforming a simple distribution chart into a ranked comparison.
-   The density estimation captures the "shape" of the population's wealth, showing where the majority cluster and how far the extremes stretch.

[***Visual Rationale***]{.underline}

I applied the `mako` color palette from the `viridis` package. This provides a striking, colorblind-friendly gradient that visually separates the overlapping ridges. The `alpha` transparency ensures that peaks in the background remain visible, while gridlines were minimized to keep the focus entirely on the data contours.
:::

```{r}
# Calculate the medians first
library(dplyr)
province_medians <- clean_data %>%
  group_by(Province) %>%
  summarize(median_income = median(Income, na.rm = TRUE))

#| fig-width: 10
#| fig-height: 6

ggplot(clean_data, aes(x = Income, y = reorder(Province, Income, FUN = median), fill = Province)) +
  geom_density_ridges(alpha = 0.7, color = "white", scale = 1.2, 
                      quantile_lines = TRUE, quantiles = 2) +
  geom_text(data = province_medians, 
            aes(x = median_income, y = Province, label = paste0(round(median_income, 1), "M")),
            size = 3.5, color = "black", fontface = "bold",
            nudge_y = 0.15, nudge_x = 2, hjust = 0) +
  scale_fill_viridis_d(option = "mako", direction = -1) +
  labs(
    title = "The Geographic Wealth Divide",
    subtitle = "Income density distributions ranked across the 5 sampled provinces",
    x = "Total Income (Million VND)", 
    y = NULL
  ) +
  theme_minimal(base_size = 10) +
  theme(legend.position = "none", 
        panel.grid.minor = element_blank(),
        plot.title = element_text(face = "bold", size = 12))
```

**Observation:**

Geography plays a foundational role in earning potential. While provinces cluster around a median income of 27.5-35 Million VND, the shape of their economies differs vastly. Yen Bai trails noticeably behind with the lowest median and a highly compressed distribution, indicating widespread baseline income with few breakout earners. Conversely, Bac Giang exhibits a significantly longer and more consistent “right tail” compared to its peers.

This indicates a higher concentration of wealthy outliers, suggesting that macro-level infrastructure or proximity to trade hubs in Bac Giang dictates a higher ceiling for earning potential compared to the more constrained distributions of the northern mountainous provinces.

## 3.2 The Gender Wage Gap & Occupational Segregation

::: callout-note
### Plot Approach

[***Technical Approach***]{.underline}

I utilized a composite layout via the `patchwork` package to connect a symptom with its cause:

Plot A employs a Density Plot (`geom_density`) to show the continuous probability distribution of income between genders.

Plot B employs a 100% Stacked Bar Chart (`geom_bar(position = "fill")`) to show the proportional makeup of job sectors for each gender.

[***Visual Rationale***]{.underline}

For Plot A, transparency (alpha = 0.6) allows the viewer to see exactly where the female distribution is "swallowed" by the male distribution. I used high-contrast `Navy` and `Red` for gender to make the distinction immediate. For Plot B, a warm `YlOrBr` palette differentiates job sectors, creating visual harmony without confusing the colors used for gender.
:::

![](images/clipboard-318702080.png)

**Figure 4. Rice fields in Northern Vietnam**

(Source: [Travel Sense Asia](https://en.travelsense.asia/experience-rice-fields-in-northern-vietnam/))

```{r}
library(dplyr)
library(scales)
library(patchwork)

#| fig-width: 12
#| fig-height: 6

# Medians for Plot A
gender_medians <- clean_data %>%
  group_by(Gender) %>%
  summarize(median_income = median(Income, na.rm = TRUE))

# Proportions for Plot B
job_props <- clean_data %>%
  count(Gender, Job_Type) %>%
  group_by(Gender) %>%
  mutate(prop = n / sum(n),
         label = percent(prop, accuracy = 1)) # Formats as "38%", "62%", etc.

# Plot A
p1 <- ggplot(clean_data, aes(x = Income, fill = Gender)) +
  geom_density(alpha = 0.6, color = NA) +
  # Add dashed vertical lines for the medians
  geom_vline(data = gender_medians, aes(xintercept = median_income, color = Gender), 
             linetype = "dashed", size = 0.7, show.legend = FALSE) +
  # Add the small text labels right next to the lines
  geom_text(data = gender_medians, 
            aes(x = median_income, y = Inf, label = paste0(round(median_income, 1), "M"), color = Gender),
            vjust = 2, hjust = -0.2, size = 3.5, fontface = "bold", show.legend = FALSE) +
  scale_fill_manual(values = c("Male" = "#2c3e50", "Female" = "#e74c3c")) +
  scale_color_manual(values = c("Male" = "#2c3e50", "Female" = "#e74c3c")) +
  labs(title = "A. Income Distribution by Gender", x = "Total Income (Million VND)", y = "Density") +
  theme_minimal() + 
  theme(legend.position = "top", plot.title = element_text(face = "bold", size = 10))

# Plot B 
# We use geom_col() instead of geom_bar() so we can easily plot the pre-calculated proportions
p2 <- ggplot(job_props, aes(x = Gender, y = prop, fill = Job_Type)) +
  geom_col(alpha = 0.9) +
  # Add the exact percentage text in the center of each stack
  geom_text(aes(label = label), position = position_stack(vjust = 0.5), 
            size = 3.5, fontface = "bold", color = "black") +
  scale_fill_brewer(palette = "YlOrBr") +
  labs(title = "B. Job Sector Segregation", x = "Gender", y = "Proportion", fill = "Sector") +
  scale_y_continuous(labels = scales::percent) +
  theme_minimal() + 
  theme(legend.position = "right", plot.title = element_text(face = "bold", size = 10))


p1 + p2 + plot_annotation(
  title = "Why do female laborers earn less?", 
  theme = theme(plot.title = element_text(size = 12, face = "bold"))
)
```

**Observation:**

Plot A reveals a clear wage gap: the female income distribution is tightly compressed at the lower end, and mostly lacks the robust high-earning "long tail" seen in the mid-to-high ranges of the male workforce.

Plot B uncovers a surprising structural reality regarding this gap. Contrary to expectations, a significantly larger proportion of men (\~79%) are concentrated in the agricultural sector compared to women (\~63%). Women actually show a higher proportional representation in the Service/Industrial and "Other" sectors.

This suggests that the wage gap seen in Plot A is not merely a result of women being confined to agriculture, but likely stems from wage disparities within these specific sectors or men holding the most lucrative outlier roles across the board.

## 3.3 The Education Premium: A ceiling on opportunity?

::: callout-note
### Plot Approach

[***Technical Approach***]{.underline}

I utilized a boxplot overlaid with a "jitter" of raw points. This hybrid approach serves two purposes:

-   The Boxplot visualizes the summary statistics (Median, IQR) which allows us to compare the "typical" earnings across groups.

-   The Jitter Points reveal the underlying sample density and prevents us from misinterpreting a boxplot based on a very small sample size.

[***Visual Rationale***]{.underline}

I used a distinct sequential color palette `GnBu` to differentiate the education levels. This reinforces the ordinal nature of the data—darker colors correspond to higher education, visually suggesting "more" or "higher" value.
:::

![](images/clipboard-2316836961.png)

**Figure** **5. A classroom in Vietnam's mountainous region**

(Source: [Childfund Australia](https://www.childfund.org.au/news-and-stories/how-technology-is-changing-education-in-vietnams-mountain-classrooms))

```{r}
# Pre-calculate the medians for each education level
edu_medians <- clean_data %>%
  group_by(Education) %>%
  summarize(median_income = median(Income, na.rm = TRUE))

#| fig-width: 12
#| fig-height: 6

ggplot(clean_data, aes(x = Education, y = Income, fill = Education)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.3, size = 1) +
  geom_label(data = edu_medians, 
             aes(x = Education, y = median_income, 
                 label = paste0(round(median_income, 1), "M")),
             vjust = -0.5,           # Push the label just slightly above the median line
             size = 4, 
             fontface = "bold", 
             color = "black",
             fill = alpha("white", 0.8), # Soft white background so it does not clash with the box/dots
             label.size = 0,         # Remove the harsh black border
             show.legend = FALSE) +  
  scale_fill_brewer(palette = "GnBu") +
  labs(
    title = "The Education Ceiling",
    subtitle = "Total Income distribution by Educational Qualification",
    x = "Education Level",
    y = "Total Income (Million VND)"
  ) +
  theme_minimal(base_size = 10) +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        plot.title = element_text(face = "bold", size = 12))
```

**Observation:**

There is a clear positive correlation between education and income, but the relationship is decidedly non-linear. While incremental gains exist between lower education tiers, such as the modest 11M VND bump from "None/Other" (27M) to "Primary" (38M).

The jump in median income from "Lower Secondary" (55M) to "Upper Secondary" (103M) is massive. This near-doubling effectively raises the baseline "floor" of earnings, as the bottom 25th percentile of Upper Secondary earners still outpaces the median of Lower Secondary earners. Notably, the Upper Secondary cohort possesses a much wider interquartile range and the highest maximum income outliers (stretching past 200M VND).

This indicates that reaching formal upper secondary education unlocks access to a much broader spectrum of higher-paying opportunities. Conversely, those with “None/Other” education face a hard income ceiling, with earnings tightly compressed around the 27M VND median and almost zero individuals breaking into the upper brackets.

## 3.4 Structural Inequality: Kinh vs. Minorities

::: callout-note
### Plot Approach

[***Technical Approach***]{.underline}

I combined a Violin Plot (`geom_violin`) with a miniaturized Boxplot (`geom_boxplot`):

The Violin Plot estimates the probability density, showing exactly where the bulk of the population lives economically.

The inner Boxplot grounds the violin by providing exact statistical markers (the median line and the IQR box).

[***Visual Rationale***]{.underline}

High-contrast colors (`Dark Orange` for Kinh, `Emerald Green` for Minorities) were chosen to sharply delineate the two demographics. The violin shape is left un-trimmed (trim = FALSE) to emphasize the long, thin tail of wealthy outliers.
:::

```{r}
# Pre-calculate the medians for each ethnic group
ethnic_medians <- clean_data %>%
  group_by(Ethnicity) %>%
  summarize(median_income = median(Income, na.rm = TRUE))

#| fig-width: 12
#| fig-height: 6

ggplot(clean_data, aes(x = Ethnicity, y = Income, fill = Ethnicity)) +
  geom_violin(trim = FALSE, alpha = 0.8) +
  geom_boxplot(width = 0.1, fill = "white", color = "black", outlier.shape = NA) +
  geom_label(data = ethnic_medians, 
             aes(x = Ethnicity, y = median_income, 
                 label = paste0(round(median_income, 1), "M")),
             nudge_x = 0.12,          # Slides the text to the right of the inner boxplot
             size = 4.5, 
             fontface = "bold", 
             color = "black",
             fill = alpha("white", 0.6), # Slightly more transparent so the violin color bleeds through
             label.size = 0,          # Removes the harsh border
             show.legend = FALSE) +
             
  scale_fill_manual(values = c("Kinh" = "#D55E00", "Minorities" = "#009E73")) +
  labs(
    title = "The Ethnic Divide",
    subtitle = "Income distribution shape and spread by Ethnicity",
    x = "Ethnic Group", 
    y = "Total Income (Million VND)"
  ) +
  theme_minimal(base_size = 10) + 
  theme(
    legend.position = "none", 
    panel.grid.major.x = element_blank(), # Removes vertical grid lines for a cleaner look
    plot.title = element_text(face = "bold", size = 12)
  )
```

**Observation:**

The violin plot exposes a stark economic divide. The Ethnic Minority distribution is heavily "bottom-weighted" with a lower median income (29 Million VND), indicating the vast majority operate at strict baseline levels with tightly compressed earnings.

In contrast, the Kinh majority displays a fundamentally different shape. While its absolute maximum earners don't reach as high as a few extreme minority outliers, the Kinh distribution has a higher median (35 Million VND) and a much thicker profile through the middle-income ranges (50-100 Million VND).

This more evenly distributed profile implies that systemic factors, such as language, geographic isolation, or unequal market access, severely restrict broad economic mobility for minorities, trapping the majority at the lower end of the income spectrum while the Kinh population enjoys much more consistent access to middle-tier incomes.

## 3.5 The Compounding Burden: Ethnicity and Education

::: callout-note
### Plot Approach

[***Technical Approach***]{.underline}

I utilized a Faceted Boxplot (`facet_wrap`) to analyze three variables simultaneously (Income, Education, and Ethnicity):

Faceting splits the data into two separate panels, allowing us to see if the "rules" of the economy apply equally to both ethnic groups.

[***Visual Rationale***]{.underline}

I maintained the exact same `GnBu` sequential palette used in Observation 3.3 for education. Consistency in color coding reduces cognitive load for the reader, allowing them to instantly recognize that darker colors mean higher education across both faceted panels.
:::

```{r}
# Pre-calculate the medians for EACH education level WITHIN each ethnic group
edu_ethnic_medians <- clean_data %>%
  group_by(Ethnicity, Education) %>%
  summarize(median_income = median(Income, na.rm = TRUE), .groups = "drop")

#| fig-width: 12
#| fig-height: 6

ggplot(clean_data, aes(x = Education, y = Income, fill = Education)) +
  geom_boxplot(alpha = 0.8, outlier.shape = 1) +
  geom_label(data = edu_ethnic_medians, 
             aes(x = Education, y = median_income, 
                 label = paste0(round(median_income, 1), "M")),
             vjust = -0.5,           # Push the label cleanly above the thick median line
             size = 3.5,             # Slightly smaller font since faceted boxes are narrower
             fontface = "bold", 
             color = "black",
             fill = alpha("white", 0.7), # Soft background for readability
             label.size = 0,         # Remove the box border
             show.legend = FALSE) +

  facet_wrap(~ Ethnicity) +
  scale_fill_brewer(palette = "GnBu") +
  labs(
    title = "Does Education Pay Equally?",
    subtitle = "Income returns on education, faceted by Ethnic Group",
    x = "Education Level", 
    y = "Total Income (Million VND)"
  ) +
  theme_bw(base_size = 10) +
  theme(
    legend.position = "none", 
    panel.grid.major.x = element_blank(), # Remove vertical gridlines for less clutter
    axis.text.x = element_text(angle = 45, hjust = 1, face = "bold"), # Bold angled text
    plot.title = element_text(face = "bold", size = 12),
    strip.text = element_text(face = "bold", size = 10),
    strip.background = element_rect(fill = "grey95", color = "grey70") 
  )
```

**Observation:**

This chart reveals a complex and unequal dynamic regarding the returns on education. For the Kinh majority, achieving an Upper Secondary education provides a highly reliable economic safety net; their income distribution is tightly clustered with a high median (104 Million VND), effectively guaranteeing a higher "floor" for earnings.

In contrast, the return on education for Ethnic Minorities is characterized by extreme variance rather than a guaranteed premium. The Upper Secondary cohort for minorities possesses the widest interquartile range on the chart. While their median earning remains lower than their Kinh counterparts and a large portion remains stuck near subsistence levels, their potential ceiling stretches vastly higher, containing some of the highest outliers in the dataset.

This suggests that while education for minorities does not overcome systemic barriers universally or provide a secure income floor, it acts as a high-stakes catalyst that unlocks massive earning potential for a select few, creating steep inequality within the minority cohort itself.

## 3.6 Moving Beyond Agriculture

::: callout-note
### Plot Approach

[***Technical Approach***]{.underline}

I utilized an aggregated Bar Chart (`geom_col`) enhanced with Error Bars (`geom_errorbar`):

The data was pre-summarized to calculate the Mean Income and the Standard Error (SE) for each job sector.

The Error Bars visually represent the reliability and volatility of that mean.

[***Visual Rationale***]{.underline}

A single, professional color (`steelblue`) was used to prevent the chart from looking like a rainbow, keeping the viewer's focus on the length of the bars and the width of the error margins. I used `coord_flip()` to ensure the category labels are perfectly horizontal and readable.
:::

```{r}
# Summarize the data (Added na.rm = TRUE just to be safe!)
job_summary <- clean_data %>% 
  group_by(Job_Type) %>% 
  summarise(
    Avg_Income = mean(Income, na.rm = TRUE), 
    SE = sd(Income, na.rm = TRUE)/sqrt(n())
  )

#| fig-width: 12
#| fig-height: 6

ggplot(job_summary, aes(x = reorder(Job_Type, Avg_Income), y = Avg_Income)) +
  geom_col(fill = "steelblue", width = 0.6, alpha = 0.9) +
  geom_errorbar(aes(ymin = Avg_Income - SE, ymax = Avg_Income + SE), 
                width = 0.15, linewidth = 0.8, color = "grey20") +
  geom_text(aes(label = paste0(round(Avg_Income, 1), " M")), 
            nudge_x = 0.35,       # Pushes the text visually up (above the bar)
            size = 4.5, 
            fontface = "bold", 
            color = "black") +
  coord_flip() +
  # Adds a bit of breathing room on the right side so the top error bar is not cut off
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) + 
  labs(
    title = "The Sector Pay Gap",
    subtitle = "Average Income by Primary Job Sector (with Standard Error)",
    x = "Job Sector", 
    y = "Average Income (Million VND)"
  ) +
  theme_minimal(base_size = 10) +
  theme(
    plot.title = element_text(face = "bold", size = 12),
    panel.grid.major.y = element_blank(),
    panel.grid.major.x = element_line(color = "grey85", linetype = "dashed"), # Softens background lines
    axis.text.y = element_text(face = "bold", size = 10, color = "grey20")  
  )
```

**Observation:**

Escaping purely agricultural work appears to be a primary mechanism for economic advancement. The Service/Industrial sector provides a substantially higher average income (approx. 50 Million VND) compared to Agriculture (34.2 Million VND).

However, the wider standard error bars on the Service and “Other” sectors reflect higher income volatility. These non-agricultural sectors likely encompass a wide spectrum of roles, from high-paying enterprise positions to lower-paying precarious work.

Conversely, Agriculture exhibits a very narrow error bar, indicating that while it provides a highly stable and predictable economic baseline, that baseline remains tightly capped at the lower end of the income spectrum.

## 3.7 The Structure of Wealth

::: callout-note
### Plot Approach

[***Technical Approach***]{.underline}

I utilized a Stacked Bar Chart (`geom_col(position = "stack")`) across ordinal wealth brackets:

The data was pivoted to separate Agri_Income from Non_Agri_Income.

Stacking allows us to see the absolute total income and the proportional composition of that income simultaneously.

[***Visual Rationale***]{.underline}

Color psychology was employed here: Brown represents "Agriculture" (earth, farming), while Green represents "Non-Agriculture" (growth, commerce). This intuitive mapping makes the drastic shift in the highest quintile instantly understandable without needing to heavily study the legend.
:::

![](images/clipboard-658152190.png)

**Figure 6. Vietnamese street vendors**

(Source: [Economica](https://www.economica.vn/news/detail/implementation-of-the-study-on-informal-employment-in-vietnam/2529))

```{r}
library(tidyr) #for pivot_longer

# Prepare the data
income_comp <- clean_data %>% 
  group_by(Quintile) %>% 
  summarise(
    Agri = mean(Agri_Income, na.rm=TRUE), 
    Non_Agri = mean(Service_Income + Other_Income, na.rm=TRUE)
  ) %>% 
  pivot_longer(-Quintile, names_to = "Source", values_to = "Value")

#| fig-width: 12
#| fig-height: 6

ggplot(income_comp, aes(x = Quintile, y = Value, fill = Source)) +
  geom_col(position = "stack", width = 0.7, alpha = 0.95) +
  geom_text(aes(label = ifelse(Value > 2, paste0(round(Value, 1), "M"), "")),
            position = position_stack(vjust = 0.5), 
            size = 2.5, 
            fontface = "bold", 
            color = "white") +
  scale_fill_manual(values = c("Agri" = "#8c564b", "Non_Agri" = "#2ca02c")) +
  # Add slightly more headroom so the tallest bar does not touch the title
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
  
  labs(
    title = "Wealth and Diversification",
    subtitle = "Absolute average income composition across Wealth Quintiles",
    x = "Income Quintile", 
    y = "Average Income Volume (Million VND)", 
    fill = "Source"
  ) +
  theme_minimal(base_size = 10) + 
  theme(
    legend.position = "top", 
    plot.title = element_text(face = "bold", size = 12),
    panel.grid.major.x = element_blank(),
    axis.text.x = element_text(face = "bold", size = 10) # Anchors the quintile categories
  )
```

**Observation:**

Wealth is not generated by simply "farming more." For the Lowest and Second quintiles, survival is derived predominantly from agriculture, which provides 16.9M and 19.1M VND respectively, dwarfing their minimal non-agricultural income (\~3.4M to 3.9M VND).

Moving up the wealth ladder, while agricultural income (the brown bar) does increase in absolute terms—growing from 16.9M at the bottom to 42.7M VND in the Top quintile. Its growth is relatively linear and capped.

The true differentiator is the sudden explosion of Non-Agricultural income (the green bar). It shifts from a minor supplement in the lower quintiles to the dominant source of wealth in the Top quintile, skyrocketing to an impressive 76.5M VND (nearly double the agricultural income of that exact same group).

This conclusively shows that agricultural intensification alone is insufficient for major economic mobility; occupational diversification into services or industry is the required catalyst to break into the highest earning brackets.

## 3.8 The Credit Catalyst

::: callout-note
### Plot Approach

[***Technical Approach***]{.underline}

I utilized a composite `patchwork` layout to track an intervention from outcome to mechanism:

Plot A uses a Boxplot to establish if credit correlates with higher total income.

Plot B uses a Scatter Plot (`geom_point`) comparing agricultural vs. non-agricultural income, mapped by credit status, to show how the money is being made.

[***Visual Rationale***]{.underline}

I used a semantic color scheme: "Grey" for No Credit (baseline status quo) and a vibrant "Green" for Has Credit (positive intervention). In the scatter plot, the alpha transparency ensures overlapping dots don't hide the density of the grey baseline trapped at the bottom.
:::

```{r}
# Filter the data
credit_data <- clean_data %>% drop_na(Credit)

# Pre-calculate the medians for Plot A (Boxplot)
credit_medians <- credit_data %>%
  group_by(Credit) %>%
  summarize(median_income = median(Income, na.rm = TRUE))

# Pre-calculate the "Centroids" for Plot B (Scatterplot)
centroid_data <- credit_data %>%
  group_by(Credit) %>%
  summarize(
    med_agri = median(Agri_Income, na.rm = TRUE),
    med_non_agri = median(Service_Income + Other_Income, na.rm = TRUE)
  )

p3 <- ggplot(credit_data, aes(x = Credit, y = Income, fill = Credit)) +
  geom_boxplot(alpha = 0.7, outlier.shape = 1) +
  geom_label(data = credit_medians, 
             aes(x = Credit, y = median_income, 
                 label = paste0(round(median_income, 1), "M")),
             vjust = -0.5, size = 4, fontface = "bold", color = "black",
             fill = alpha("white", 0.8), label.size = 0, show.legend = FALSE) + 
  scale_fill_manual(values = c("No Credit" = "#bdc3c7", "Has Credit" = "#27ae60")) +
  labs(title = "A. Income by Credit Access", x = NULL, y = "Total Income (Million VND)") +
  theme_minimal(base_size = 10) + 
  theme(legend.position = "none", 
        plot.title = element_text(face = "bold", size = 10),
        axis.text.x = element_text(face = "bold", size = 10),
        panel.grid.major.x = element_blank()) # Clean background

p4 <- ggplot(credit_data, aes(x = Agri_Income, y = Service_Income + Other_Income, color = Credit)) +
  geom_point(alpha = 0.5, size = 2) + # Dropped alpha slightly so overlapping points are clearer
  geom_point(data = centroid_data, 
             aes(x = med_agri, y = med_non_agri, fill = Credit),
             shape = 23,        # 23 is a diamond shape that can have a border
             size = 5,          # Make it large
             color = "black",   # Give it a crisp black border to stand out
             stroke = 1.2, 
             show.legend = FALSE) +
             
  scale_color_manual(values = c("No Credit" = "#bdc3c7", "Has Credit" = "#27ae60")) +
  scale_fill_manual(values = c("No Credit" = "#bdc3c7", "Has Credit" = "#27ae60")) +
  labs(title = "B. Income Diversification", 
       x = "Agri Income (Mil VND)", 
       y = "Non-Agri Income (Mil VND)",
       color = "Credit Access") +
  theme_minimal(base_size = 10) + 
  theme(legend.position = "right", 
        plot.title = element_text(face = "bold", size = 10))

#| fig-width: 12
#| fig-height: 6

p3 + p4 + plot_annotation(
  title = "The Impact of Microfinance"
  theme = theme(
    plot.title = element_text(size = 12, face = "bold", margin = margin(b = 15)),
    plot.caption = element_text(color = "grey50", size = 10)
  )
)
```

**Observation:**

Access to credit appears to introduce mid-level income variance rather than acting as a guaranteed baseline elevator or a catalyst for extreme wealth. Plot A shows that laborers with and without credit share a nearly identical median income (32.5M vs 32M). However, the "Has Credit" cohort displays a slightly wider interquartile range and a lower bottom whisker, indicating that microfinance carries risk: it introduces more income variability without necessarily raising the baseline "floor" of earnings.

Plot B reveals a nuanced reality regarding diversification. While credit access allows laborers to experiment with non-agricultural work, it is not the primary driver of the highest-tier enterprises. The highest non-agricultural earners, as well as the most extreme total income outliers in Plot A, belong overwhelmingly to the "No Credit" group.

This implies that while microfinance provides initial capital for mid-level entrepreneurial attempts, the most lucrative, high-ceiling ventures are likely self-funded or operated by households that have outgrown the need for microcredit entirely.

![](images/clipboard-1218621449.png)

**Figure 7. Modern Vietnam at night**

(Source: The Internet)

# Food for Thought & Conclusion: Beyond the Modern Occupations

If history once divided society into **the Four Occupations**, today’s rural economy appears to operate under a quieter but equally powerful classification system: one shaped by education, geography, gender, ethnicity, and access to capital. The dataset reveals that while Vietnam has long moved beyond its feudal structure in law and governance, the echoes of historical hierarchies continue to shape how labor is valued and rewarded. Agriculture, once the moral backbone of society, now functions less as a path to stability and more as a tightly capped baseline of survival. Meanwhile, education and occupational diversification, the modern equivalents of social mobility, serve as the necessary gateways to prosperity.

**Yet the data complicates any simplistic narrative of progress.** Education does raise incomes, but its function fractures along ethnic lines: for the Kinh majority, it provides a reliable economic safety net, whereas for ethnic minorities, it acts as a high-stakes gamble defined by extreme variance. The modern shift away from agriculture into services and trade is the undeniable engine of top-tier wealth. However, this transition is not a universal equalizer; paradoxically, women have diversified out of agriculture at higher rates than men, yet remain disproportionately trapped beneath the wage ceilings of those very same sectors. Furthermore, while interventions like microcredit introduce crucial mid-level entrepreneurial mobility, the data explicitly shows that the absolute highest economic strata are occupied almost entirely by self-funded households who have outgrown the need for leverage.

The deeper lesson emerging from this analysis is that upward mobility is rarely the result of a single intervention. Instead, it is the product of intersecting advantages: education that unlocks non-agricultural work, capital that enables risk-taking, and structural conditions that allow individuals to step beyond inherited demographic roles. Where these forces align, we see income ceilings shatter and new pathways emerge. Where they do not, individuals remain trapped within invisible boundaries that resemble the old social categories, only now hidden beneath modern economic terminology.

**Ultimately, “Beyond the Harvest: What the Fields Do Not Yield”** is not simply about income differences among rural laborers. It is a reflection on how historical mindsets, structural inequalities, and contemporary economic forces converge to shape the lived realities of Vietnam’s most vulnerable populations. The question facing policymakers and development practitioners is not whether rural communities can produce more from the land, but whether systems can be built that allow individuals to move beyond it, without abandoning the cultural and social foundations that define rural life.

In a country whose past once ranked citizens by occupation, the modern challenge lies in ensuring that occupation no longer determines destiny. True progress will not be measured solely by increased harvests or rising averages, but by whether the next generation of rural laborers can choose their paths freely, unbound by the quiet hierarchies that history left behind.
